upgrading
upgradeGLASS
  "skip this step if GLASS1 is already loaded"

  | glassVersion |
  self glass1Loaded
    ifTrue: [ 
      self inform: 'GLASS1 is loaded. Skipping GLASS upgrade.'.
      ^ self ].
  glassVersion := ConfigurationOfGLASS project currentVersion.
  self metacelloPreviewLoaded
    ifTrue: [ 
      self inform: 'MetacelloPreview is loaded. Skipping GLASS upgrade.'.
      ^ self ].
  glassVersion versionNumber < '1.0-beta.9.3' asMetacelloVersionNumber
    ifTrue: [ 
      self log: 'Upgrading GLASS to 1.0-beta.9.3'.
      GsDeployer
        deploy: [ 
          Gofer new
            package: 'ConfigurationOfGLASS';
            url: 'http://seaside.gemtalksystems.com/ss/MetacelloRepository';
            load.
          glassVersion versionNumber < '1.0-beta.9.2' asMetacelloVersionNumber
            ifTrue: [ 
              [ 
              (Smalltalk at: #'ConfigurationOfMetacello') project version
                <= '1.0-beta.31.1' asMetacelloVersionNumber
                ifTrue: [ 
                  "load basic Metacello packages for version 1.0-beta.31.1. 
                   To load GLASS 1.0-beta.8.7.1:
	                  - Metacello must handle symbolic versions
	                  - MetacelloSkipDirtyPackageLoad needs to be defined"
                  (Smalltalk at: #'Gofer') new
                    gemsource: 'metacello';
                    version: 'Metacello-Base-DaleHenrichs.19';
                    version: 'Metacello-Core-dkh.468';
                    version: 'Metacello-MC-dkh.531';
                    load.
                  (Smalltalk at: #'Gofer') new
                    gemsource: 'metacello';
                    version: 'Metacello-Platform.gemstone-dkh.23';
                    load ].
              ((Smalltalk at: #'ConfigurationOfGLASS') project
                version: '1.0-beta.9.2')
                load: #('Core' 'Monticello' 'Gofer Project Loader').
              ((Smalltalk at: #'ConfigurationOfGLASS') project
                version: '1.0-beta.9.2') load ]
                on: MetacelloSkipDirtyPackageLoad
                do: [ :ex | ex resume: false ] ].
          ((Smalltalk at: #'ConfigurationOfGLASS') project
            version: '1.0-beta.9.3') load ] ]
    ifFalse: [ self log: 'GLASS already upgraded to 1.0-beta.9.3' ]